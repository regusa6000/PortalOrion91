<nb-card size="large" style="height: 100%; width: 100%;">

  <nb-card-header>
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <div>
        <span><b>Abonos</b></span>
      </div>
      <div>
        <span *ngIf="fechaInicio != null">Fechas: {{ fechaInicio }} - {{ fechaFin }} , <span style="color: red;"> Total Abonado: {{ total | currency:'EUR': true}}</span></span>
      </div>
    </div>

  </nb-card-header>

  <nb-card-body class="two-inputs">

    <div style="display: flex; justify-content: flex-end;" >
      <div>
        <input nbInput placeholder="Seleccionar Fecha:" [nbDatepicker]="rangepicker">
        <nb-rangepicker #rangepicker (rangeChange)="cambioRango($event)"></nb-rangepicker>
      </div>

      <div>
        <button nbButton status="primary" style="margin-left: 15px;" (click)="buscarAbono()">Buscar</button>
      </div>
    </div>

    <br><br>

    <!--Tabla de Abonos según fechas-->
    <div class="table-responsive cnstr-record product-tbl">
      <table class="table table-bordered heading-hvr">
        <thead>
          <tr style="text-align: center;">
            <th> </th>
            <th>AB</th>
            <th>PVC</th>
            <th>OR</th>
            <th>TRANSPORTE</th>
            <th>TOTAL PRODUCTOS</th>
            <th>TOTAL ABONO</th>
            <th>FECHA ABONO</th>
          </tr>
        </thead>
        <tbody *ngFor="let abo of abonos; let i = index">
          <tr>
            <td align="center">
                <nb-icon icon="maximize-outline" pack="eva" class="expand-row" *ngIf="!hideme[i]" (click)="showLinea(i)"></nb-icon>
                <nb-icon icon="minimize-outline" pack="eva" class="expand-row" *ngIf="hideme[i]" (click)="hideme[i] = !hideme[i]"></nb-icon>
            </td>
            <td align="center">{{abo.idFactura}}</td>
            <td align="center">{{abo.pedidoAx}}</td>
            <td align="center">{{abo.referenciaPs}}</td>
            <td align="right">0,00 €</td>
            <td align="right">{{ abo.cantidadProductos }}</td>
            <td align="right">{{abo.precioFinal| currency:'EUR': true}}</td>
            <td align="right">{{ abo.fechaFactura }}</td>
          </tr>

          <tr [hidden]="!hideme[i]" class="sub-table no-bg">
            <td align="center"> </td>
            <td colspan="15" class="p-0">
              <ngx-abonos-lineas [orPedido]="abo.referenciaPs"></ngx-abonos-lineas>
            </td>
          </tr>

        </tbody>
      </table>


    </div>

  </nb-card-body>



</nb-card>
